<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en">
  <head>
	  <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <script type="text/javascript">
      IFRAME_SOURCE = 'file:///Users/b.brodersen/Development/git/iframe_communication/iframe.html';
      IFRAME_ID = IFRAME_SOURCE

      window.onload = function () {
        document.body = document.getElementsByTagName("body")[0];

        iframe = document.createElement('iframe');
        iframe.id = IFRAME_ID
        iframe.src = IFRAME_SOURCE;
        iframe.style.display = "none";
        iframe.width = 1;
        iframe.height = 1;

        document.body.appendChild(iframe);

        iframeWindow = iframe.contentWindow;

        iframe.onload = function () {
          postConstruct();
        };
      };

      function postConstruct(){
        var message = '\<script\>alert(window.location)\</script\>';

        iframeWindow.postMessage(message, "*");
      }

    </script>
  </head>
  <body>
  </body>
</html>
